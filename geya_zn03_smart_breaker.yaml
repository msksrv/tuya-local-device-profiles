name: GEYA ZN03 Smart Breaker
products:
  - id: 4e1m069xd4qlqji5
  - id: e1n0ryu4

entities:

  # Основной автомат
  - entity: switch
    name: Breaker
    icon: mdi:breaker-switch
    dps:
      - id: 16
        type: boolean
        name: switch

  # Напряжение
  - entity: sensor
    name: Voltage
    class: voltage
    dps:
      - id: 102
        type: integer
        name: sensor
        unit: V
        class: measurement
        mapping:
          - scale: 10

  # -------------------------
  # OVERVOLTAGE (повышенное)
  # -------------------------

  # Порог перенапряжения
  - entity: number
    name: Over Voltage Limit
    icon: mdi:arrow-collapse-up
    dps:
      - id: 141
        type: integer
        name: value
        unit: V
        range:
          min: 250
          max: 300

  # Задержка перенапряжения
  - entity: number
    name: Over Voltage Delay
    icon: mdi:timer
    dps:
      - id: 151
        type: integer
        name: value
        unit: s
        range:
          min: 1
          max: 10

  # Что делать при перенапряжении (выключено / тревога / отключить)
  - entity: select
    name: Overvoltage Action
    icon: mdi:flash-alert
    dps:
      - id: 161
        type: string
        name: option
        mapping:
          - dps_val: "Close"
            value: "Disabled"
          - dps_val: "Alarm"
            value: "Alarm"
          - dps_val: "Trip"
            value: "Trip"

  # -------------------------
  # UNDERVOLTAGE (пониженное)
  # -------------------------

  # Порог пониженного напряжения
  - entity: number
    name: Under Voltage Limit
    icon: mdi:arrow-collapse-down
    dps:
      - id: 142
        type: integer
        name: value
        unit: V
        range:
          min: 160
          max: 200

  # Задержка пониженного напряжения
  - entity: number
    name: Under Voltage Delay
    icon: mdi:timer-outline
    dps:
      - id: 152
        type: integer
        name: value
        unit: s
        range:
          min: 1
          max: 10

  # Что делать при пониженном (выключено / тревога / отключить)
  - entity: select
    name: Undervoltage Action
    icon: mdi:arrow-down-bold
    dps:
      - id: 162
        type: string
        name: option
        mapping:
          - dps_val: "Close"
            value: "Disabled"
          - dps_val: "Alarm"
            value: "Alarm"
          - dps_val: "Trip"
            value: "Trip"

  # Автоперезапуск
  - entity: switch
    name: Auto Reclose Enable
    icon: mdi:restart-alert
    dps:
      - id: 165
        type: boolean
        name: switch

  # Состояние автомата/защит (как есть, без записи)
  - entity: sensor
    name: Breaker State
    icon: mdi:toggle-switch
    dps:
      - id: 163
        type: string
        name: sensor

  # Лог событий (реальное событие)
  - entity: sensor
    name: Realtime Event
    category: diagnostic
    icon: mdi:alert-decagram
    dps:
      - id: 191
        type: string
        name: sensor
